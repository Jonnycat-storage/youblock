{"version":3,"mappings":"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","names":["shaka","n","hotkeys","__vitePreload","_sfc_main","ModalComponent","_this","preferredVideoCodecs","enabledCodecs","mod","_b","_a","segment","self","e","handler","videoEl","chapter","component","noPrevPlayer","streams","MseSupport","lbry","uri","mime","url","dash","generate_dash_file_from_formats","stream","localPlayer","proxyURL","proxyPath","_type","request","headers","time","rate","s","OpenButton","parent","controls","label","rootElement","overflowMenuButtons","config","event","player","disableVideo","prefetchLimit","quality","qualityConds","startTime","parseTimeParam","resolve","tx","store","video","currentTime","prefLang","lang","l","newOverflowMenuButtons","leastDiff","bestStream","bestAudio","tracks","track","audioBandwidth","a","b","diff","subtitle","autoDisplayCaptions","prefSubtitles","textTracks","subtitleIdx","textTrack","seekbar","array","start","newSpeed","normalizedSpeed","newVolume","normalizedVolume","err","markers","end","color","seekBar","position","frame","originalImage","container","canvas","ctx","offsetX","offsetY","left","maxLeft","startPosition","framePage","i","positionY","positionX","endPosition","r","node","_hoisted_1","_hoisted_5","_hoisted_6","_hoisted_7","_createElementVNode","_hoisted_11","_hoisted_15","_hoisted_16","_hoisted_17","_openBlock","_createElementBlock","_Fragment","_normalizeClass","$props","$options","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","$data","_createCommentVNode","_ctx","args","_withDirectives","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_12","_hoisted_13","_hoisted_14","_createBlock","_component_ModalComponent","_withCtx","_cache","$event","_withKeys","CollapsableText","json","_createVNode","_component_router_link","_createTextVNode","_component_CollapsableText","_hoisted_18","_hoisted_19","_renderList","reply","_component_CommentItem","_hoisted_20","props","__props","isCurrentChapter","index","VideoItem","nextTick","elems","elm","related","_component_VideoItem","_renderSlot","VideoPlayer","ContentItem","ErrorHandler","CommentItem","ChaptersBar","PlaylistAddModal","ShareModal","PlaylistVideos","WatchOnButton","LoadingIndicatorPage","ToastComponent","smallViewQuery","purifyHTML","link","videoId","instance","selectedSkip","skipOptions","k","sponsors","option","minSegmentLength","data","xmlDoc","elem","rewriteDescription","success","target","videos_list","params","video_ids","_f","_e","_d","_c","searchParams","param","paramStr","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_29","_hoisted_31","_hoisted_33","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_41","_hoisted_42","_hoisted_44","_hoisted_45","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_52","_hoisted_54","_component_VideoPlayer","_component_LoadingIndicatorPage","_component_ErrorHandler","_Transition","_component_ToastComponent","_component_i18n_t","_KeepAlive","_component_ChaptersBar","_component_PlaylistAddModal","_component_ShareModal","_hoisted_21","_hoisted_26","_hoisted_27","_component_WatchOnButton","_hoisted_28","metaInfo","linkIndex","_hoisted_30","_hoisted_32","_hoisted_34","_hoisted_39","tag","_vShow","_hoisted_40","_hoisted_43","_hoisted_46","_g","_h","_hoisted_53","_hoisted_55","comment","_hoisted_51","_hoisted_50","_hoisted_56","_component_PlaylistVideos","_component_ContentItem","_hoisted_57"],"ignoreList":[],"sources":["../../src/components/VideoPlayer.vue","../../src/components/CommentItem.vue","../../src/components/ChaptersBar.vue","../../src/components/PlaylistVideos.vue","../../src/components/ToastComponent.vue","../../src/components/WatchVideo.vue"],"sourcesContent":["<template>\n    <div\n        ref=\"container\"\n        data-shaka-player-container\n        class=\"relative max-h-screen w-full flex justify-center\"\n        :class=\"{ 'player-container': !isEmbed }\"\n    >\n        <video ref=\"videoEl\" class=\"w-full\" data-shaka-player :autoplay=\"shouldAutoPlay\" :loop=\"selectedAutoLoop\" />\n        <span\n            id=\"preview-container\"\n            ref=\"previewContainer\"\n            class=\"absolute bottom-0 z-[2000] mb-[3.5%] hidden flex-col items-center\"\n        >\n            <canvas id=\"preview\" ref=\"preview\" class=\"rounded-sm\" />\n            <span\n                v-if=\"video.chapters.length > 1\"\n                class=\"mt-2 text-sm drop-shadow-[0_0_2px_white] -mb-2 .dark:drop-shadow-[0_0_2px_black]\"\n            >\n                {{ video.chapters.findLast(chapter => chapter.start < currentTime)?.title }}\n            </span>\n            <span\n                class=\"mt-2 w-min rounded-xl bg-white px-2 pb-1 pt-1.5 text-sm .dark:bg-dark-700\"\n                v-text=\"timeFormat(currentTime)\"\n            />\n        </span>\n        <button\n            v-if=\"inSegment\"\n            class=\"skip-segment-button\"\n            type=\"button\"\n            :aria-label=\"$t('actions.skip_segment')\"\n            aria-pressed=\"false\"\n            @click=\"onClickSkipSegment\"\n        >\n            <span v-t=\"'actions.skip_segment'\" />\n            <i class=\"material-icons-round\">skip_next</i>\n        </button>\n        <span\n            v-if=\"error > 0\"\n            v-t=\"{ path: 'player.failed', args: [error] }\"\n            class=\"absolute top-8 rounded bg-black/80 p-2 text-lg backdrop-blur-sm\"\n        />\n        <div\n            v-if=\"showCurrentSpeed\"\n            class=\"text-l absolute left-1/2 top-1/2 flex flex-col transform items-center gap-6 rounded-8 bg-white/80 px-8 py-4 -translate-x-1/2 -translate-y-1/2 .dark:bg-dark-700/80\"\n        >\n            <i class=\"i-fa6-solid:gauge-high h-25 w-25 p-5\" />\n            <span v-text=\"$refs.videoEl.playbackRate\" />\n        </div>\n        <div\n            v-if=\"showCurrentVolume\"\n            class=\"text-l absolute left-1/2 top-1/2 flex flex-col transform items-center gap-6 rounded-8 bg-white/80 px-8 py-4 -translate-x-1/2 -translate-y-1/2 .dark:bg-dark-700/80\"\n        >\n            <i v-if=\"$refs.videoEl.volume > 0\" class=\"i-fa6-solid:volume-high h-25 w-25 p-5\" />\n            <i v-else class=\"i-fa6-solid:volume-xmark h-25 w-25 p-5\" />\n            <span v-text=\"Math.round($refs.videoEl.volume * 100) / 100\" />\n        </div>\n    </div>\n\n    <ModalComponent v-if=\"showSpeedModal\" @close=\"showSpeedModal = false\">\n        <h2 v-t=\"'actions.playback_speed'\" />\n        <div class=\"flex flex-col\">\n            <input\n                v-model=\"playbackSpeedInput\"\n                class=\"input my-3\"\n                type=\"text\"\n                :placeholder=\"$t('actions.playback_speed')\"\n                @keyup.enter=\"setSpeedFromInput()\"\n            />\n            <button v-t=\"'actions.okay'\" class=\"btn ml-auto w-min\" @click=\"setSpeedFromInput()\" />\n        </div>\n    </ModalComponent>\n</template>\n\n<script>\nimport \"shaka-player/dist/controls.css\";\nimport { parseTimeParam } from \"@/utils/Misc\";\nimport ModalComponent from \"./ModalComponent.vue\";\n\nconst shaka = import(\"shaka-player/dist/shaka-player.ui.js\");\nconst hotkeys = import(\"hotkeys-js\");\n\nexport default {\n    components: { ModalComponent },\n    props: {\n        video: {\n            type: Object,\n            default: () => {\n                return {};\n            },\n        },\n        sponsors: {\n            type: Object,\n            default: () => {\n                return {};\n            },\n        },\n        selectedAutoPlay: Boolean,\n        selectedAutoLoop: Boolean,\n        isEmbed: Boolean,\n    },\n    emits: [\"timeupdate\", \"ended\", \"navigateNext\"],\n    data() {\n        return {\n            lastUpdate: new Date().getTime(),\n            initialSeekComplete: false,\n            destroying: false,\n            inSegment: false,\n            isHoveringTimebar: false,\n            showSpeedModal: false,\n            showCurrentSpeed: false,\n            hideCurrentSpeed: null,\n            showCurrentVolume: false,\n            hideCurrentVolume: null,\n            playbackSpeedInput: null,\n            currentTime: 0,\n            seekbarPadding: 2,\n            error: 0,\n        };\n    },\n    computed: {\n        shouldAutoPlay: _this => {\n            return _this.getPreferenceBoolean(\"playerAutoPlay\", true) && !_this.isEmbed;\n        },\n        preferredVideoCodecs: _this => {\n            var preferredVideoCodecs = [];\n            const enabledCodecs = _this.getPreferenceString(\"enabledCodecs\", \"vp9,avc\").split(\",\");\n\n            if (\n                _this.$refs.videoEl.canPlayType('video/mp4; codecs=\"av01.0.08M.08\"') !== \"\" &&\n                enabledCodecs.includes(\"av1\")\n            )\n                preferredVideoCodecs.push(\"av01\");\n            if (_this.$refs.videoEl.canPlayType('video/webm; codecs=\"vp9\"') !== \"\" && enabledCodecs.includes(\"vp9\"))\n                preferredVideoCodecs.push(\"vp9\");\n            if (\n                _this.$refs.videoEl.canPlayType('video/mp4; codecs=\"avc1.4d401f\"') !== \"\" &&\n                enabledCodecs.includes(\"avc\")\n            )\n                preferredVideoCodecs.push(\"avc1\");\n\n            return preferredVideoCodecs;\n        },\n    },\n    mounted() {\n        if (!this.$shaka) this.shakaPromise = shaka.then(shaka => shaka.default).then(shaka => (this.$shaka = shaka));\n        if (!this.$hotkeys)\n            this.hotkeysPromise = hotkeys.then(mod => mod.default).then(hotkeys => (this.$hotkeys = hotkeys));\n    },\n    activated() {\n        this.destroying = false;\n        this.sponsors?.segments?.forEach(segment => (segment.skipped = false));\n        this.hotkeysPromise.then(() => {\n            var self = this;\n            this.$hotkeys(\n                \"f,m,j,k,l,c,space,up,down,left,right,ctrl+left,ctrl+right,home,end,0,1,2,3,4,5,6,7,8,9,shift+n,shift+s,shift+,,shift+.,alt+p,return,.,,\",\n                function (e, handler) {\n                    const videoEl = self.$refs.videoEl;\n                    switch (handler.key) {\n                        case \"f\":\n                            self.$ui.getControls().toggleFullScreen();\n                            e.preventDefault();\n                            break;\n                        case \"m\":\n                            videoEl.muted = !videoEl.muted;\n                            e.preventDefault();\n                            break;\n                        case \"j\":\n                            videoEl.currentTime = Math.max(videoEl.currentTime - 15, 0);\n                            e.preventDefault();\n                            break;\n                        case \"l\":\n                            videoEl.currentTime = videoEl.currentTime + 15;\n                            e.preventDefault();\n                            break;\n                        case \"c\":\n                            self.$player.setTextTrackVisibility(!self.$player.isTextTrackVisible());\n                            e.preventDefault();\n                            break;\n                        case \"k\":\n                        case \"space\":\n                            if (videoEl.paused) videoEl.play();\n                            else videoEl.pause();\n                            e.preventDefault();\n                            break;\n                        case \"up\":\n                            self.adjustPlaybackVolume(videoEl.volume + 0.05);\n                            e.preventDefault();\n                            break;\n                        case \"down\":\n                            self.adjustPlaybackVolume(videoEl.volume - 0.05);\n                            e.preventDefault();\n                            break;\n                        case \"left\":\n                            videoEl.currentTime = Math.max(videoEl.currentTime - 5, 0);\n                            e.preventDefault();\n                            break;\n                        case \"right\":\n                            videoEl.currentTime = videoEl.currentTime + 5;\n                            e.preventDefault();\n                            break;\n                        case \"ctrl+left\": {\n                            videoEl.currentTime = self.video.chapters.findLast(\n                                chapter => chapter.start < videoEl.currentTime,\n                            ).start;\n                            e.preventDefault();\n                            break;\n                        }\n                        case \"ctrl+right\": {\n                            videoEl.currentTime =\n                                self.video.chapters.find(chapter => chapter.start > videoEl.currentTime)?.start ||\n                                videoEl.duration;\n                            e.preventDefault();\n                            break;\n                        }\n                        case \"home\":\n                            videoEl.currentTime = 0;\n                            e.preventDefault();\n                            break;\n                        case \"end\":\n                            videoEl.currentTime = videoEl.duration;\n                            e.preventDefault();\n                            break;\n                        case \"0\":\n                            videoEl.currentTime = 0;\n                            e.preventDefault();\n                            break;\n                        case \"1\":\n                            videoEl.currentTime = videoEl.duration * 0.1;\n                            e.preventDefault();\n                            break;\n                        case \"2\":\n                            videoEl.currentTime = videoEl.duration * 0.2;\n                            e.preventDefault();\n                            break;\n                        case \"3\":\n                            videoEl.currentTime = videoEl.duration * 0.3;\n                            e.preventDefault();\n                            break;\n                        case \"4\":\n                            videoEl.currentTime = videoEl.duration * 0.4;\n                            e.preventDefault();\n                            break;\n                        case \"5\":\n                            videoEl.currentTime = videoEl.duration * 0.5;\n                            e.preventDefault();\n                            break;\n                        case \"6\":\n                            videoEl.currentTime = videoEl.duration * 0.6;\n                            e.preventDefault();\n                            break;\n                        case \"7\":\n                            videoEl.currentTime = videoEl.duration * 0.7;\n                            e.preventDefault();\n                            break;\n                        case \"8\":\n                            videoEl.currentTime = videoEl.duration * 0.8;\n                            e.preventDefault();\n                            break;\n                        case \"9\":\n                            videoEl.currentTime = videoEl.duration * 0.9;\n                            e.preventDefault();\n                            break;\n                        case \"shift+n\":\n                            self.$emit(\"navigateNext\");\n                            e.preventDefault();\n                            break;\n                        case \"shift+s\":\n                            self.showSpeedModal = true;\n                            break;\n                        case \"shift+,\":\n                            self.adjustPlaybackSpeed(videoEl.playbackRate - 0.25);\n                            break;\n                        case \"shift+.\":\n                            self.adjustPlaybackSpeed(videoEl.playbackRate + 0.25);\n                            break;\n                        case \"alt+p\":\n                            document.pictureInPictureElement\n                                ? document.exitPictureInPicture()\n                                : videoEl.requestPictureInPicture();\n                            break;\n                        case \"return\":\n                            self.skipSegment(videoEl);\n                            break;\n                        case \".\":\n                            videoEl.currentTime += 0.04;\n                            e.preventDefault();\n                            break;\n                        case \",\":\n                            videoEl.currentTime -= 0.04;\n                            e.preventDefault();\n                            break;\n                    }\n                },\n            );\n        });\n    },\n    deactivated() {\n        this.destroying = true;\n        this.destroy(true);\n    },\n    unmounted() {\n        this.destroying = true;\n        this.destroy(true);\n    },\n    methods: {\n        async loadVideo() {\n            this.updateSponsors();\n\n            const component = this;\n            const videoEl = this.$refs.videoEl;\n\n            videoEl.setAttribute(\"poster\", this.video.thumbnailUrl);\n\n            const noPrevPlayer = !this.$player;\n\n            var streams = [];\n\n            streams.push(...this.video.audioStreams);\n            streams.push(...this.video.videoStreams);\n\n            const MseSupport = window.MediaSource !== undefined;\n\n            const lbry = null;\n\n            var uri;\n            var mime;\n\n            if (this.video.livestream) {\n                uri = this.video.hls;\n                mime = \"application/x-mpegURL\";\n            } else if (\n                this.video.audioStreams.length > 0 &&\n                !lbry &&\n                MseSupport &&\n                !this.getPreferenceBoolean(\"preferHls\", false)\n            ) {\n                if (!this.video.dash) {\n                    const dash = (await import(\"../utils/DashUtils.js\")).generate_dash_file_from_formats(\n                        streams,\n                        this.video.duration,\n                    );\n\n                    uri = \"data:application/dash+xml;charset=utf-8;base64,\" + btoa(dash);\n                } else {\n                    const url = new URL(this.video.dash);\n                    url.searchParams.set(\"rewrite\", false);\n                    uri = url.toString();\n                }\n                mime = \"application/dash+xml\";\n            } else if (lbry) {\n                uri = lbry.url;\n                if (this.getPreferenceBoolean(\"proxyLBRY\", false)) {\n                    const url = new URL(uri);\n                    const proxyURL = new URL(this.video.proxyUrl);\n                    let proxyPath = proxyURL.pathname;\n                    if (proxyPath.lastIndexOf(\"/\") === proxyPath.length - 1) {\n                        proxyPath = proxyPath.substring(0, proxyPath.length - 1);\n                    }\n\n                    url.searchParams.set(\"host\", url.host);\n                    url.protocol = proxyURL.protocol;\n                    url.host = proxyURL.host;\n                    url.pathname = proxyPath + url.pathname;\n                    uri = url.toString();\n                }\n                const contentType = await fetch(uri, {\n                    method: \"HEAD\",\n                }).then(response => {\n                    uri = response.url;\n                    return response.headers.get(\"Content-Type\");\n                });\n                mime = contentType;\n            } else if (this.video.hls) {\n                uri = this.video.hls;\n                mime = \"application/x-mpegURL\";\n            } else {\n                uri = this.video.videoStreams.findLast(stream => stream.codec == null).url;\n                mime = \"video/mp4\";\n            }\n\n            if (noPrevPlayer)\n                this.shakaPromise.then(async () => {\n                    if (this.destroying) return;\n                    this.$shaka.polyfill.installAll();\n\n                    const localPlayer = new this.$shaka.Player();\n                    await localPlayer.attach(videoEl);\n                    const proxyURL = new URL(component.video.proxyUrl);\n                    let proxyPath = proxyURL.pathname;\n                    if (proxyPath.lastIndexOf(\"/\") === proxyPath.length - 1) {\n                        proxyPath = proxyPath.substring(0, proxyPath.length - 1);\n                    }\n\n                    localPlayer.getNetworkingEngine().registerRequestFilter((_type, request) => {\n                        const uri = request.uris[0];\n                        var url = new URL(uri);\n                        const headers = request.headers;\n                        if (\n                            url.host.endsWith(\".googlevideo.com\") ||\n                            (url.host.endsWith(\".lbryplayer.xyz\") &&\n                                (component.getPreferenceBoolean(\"proxyLBRY\", false) || headers.Range))\n                        ) {\n                            url.searchParams.set(\"host\", url.host);\n                            url.protocol = proxyURL.protocol;\n                            url.host = proxyURL.host;\n                            url.pathname = proxyPath + url.pathname;\n                            request.uris[0] = url.toString();\n                        }\n                        if (url.pathname === proxyPath + \"/videoplayback\") {\n                            if (headers.Range) {\n                                url.searchParams.set(\"range\", headers.Range.split(\"=\")[1]);\n                                request.headers = {};\n                                request.uris[0] = url.toString();\n                            }\n                        }\n                    });\n\n                    localPlayer.configure(\n                        \"streaming.bufferingGoal\",\n                        Math.max(this.getPreferenceNumber(\"bufferGoal\", 10), 10),\n                    );\n                    localPlayer.configure(\"streaming.bufferBehind\", 300);\n\n                    this.setPlayerAttrs(localPlayer, videoEl, uri, mime, this.$shaka);\n                });\n            else this.setPlayerAttrs(this.$player, videoEl, uri, mime, this.$shaka);\n\n            if (noPrevPlayer) {\n                videoEl.addEventListener(\"loadeddata\", () => {\n                    if (document.pictureInPictureElement) videoEl.requestPictureInPicture();\n                });\n                videoEl.addEventListener(\"timeupdate\", () => {\n                    const time = videoEl.currentTime;\n                    this.$emit(\"timeupdate\", time);\n                    this.updateProgressDatabase(time);\n                    if (this.sponsors && this.sponsors.segments) {\n                        const segment = this.findCurrentSegment(time);\n                        this.inSegment = !!segment;\n                        if (segment?.autoskip && (!segment.skipped || this.selectedAutoLoop)) {\n                            this.skipSegment(videoEl, segment);\n                        }\n                    }\n                });\n\n                videoEl.addEventListener(\"volumechange\", () => {\n                    this.setPreference(\"volume\", videoEl.volume, true);\n                });\n\n                videoEl.addEventListener(\"ratechange\", e => {\n                    const rate = videoEl.playbackRate;\n                    if (rate > 0 && !isNaN(videoEl.duration) && !isNaN(videoEl.duration - e.timeStamp / 1000))\n                        this.setPreference(\"rate\", rate, true);\n                });\n\n                videoEl.addEventListener(\"ended\", () => {\n                    this.$emit(\"ended\");\n                });\n            }\n            //TODO: Add sponsors on seekbar: https://github.com/ajayyy/SponsorBlock/blob/e39de9fd852adb9196e0358ed827ad38d9933e29/src/js-components/previewBar.ts#L12\n        },\n        findCurrentSegment(time) {\n            return this.sponsors?.segments?.find(s => time >= s.segment[0] && time < s.segment[1]);\n        },\n        onClickSkipSegment() {\n            const videoEl = this.$refs.videoEl;\n            this.skipSegment(videoEl);\n        },\n        skipSegment(videoEl, segment) {\n            const time = videoEl.currentTime;\n            if (!segment) segment = this.findCurrentSegment(time);\n            if (!segment) return;\n            console.log(\"Skipped segment at \" + time);\n            videoEl.currentTime = segment.segment[1];\n            segment.skipped = true;\n        },\n        async setPlayerAttrs(localPlayer, videoEl, uri, mime, shaka) {\n            const url = \"/watch?v=\" + this.video.id;\n\n            if (!this.$ui) {\n                this.destroy();\n                const OpenButton = class extends shaka.ui.Element {\n                    constructor(parent, controls) {\n                        super(parent, controls);\n\n                        this.newTabButton_ = document.createElement(\"button\");\n                        this.newTabButton_.classList.add(\"shaka-cast-button\");\n                        this.newTabButton_.classList.add(\"shaka-tooltip\");\n                        this.newTabButton_.ariaPressed = \"false\";\n\n                        this.newTabIcon_ = document.createElement(\"i\");\n                        this.newTabIcon_.classList.add(\"material-icons-round\");\n                        this.newTabIcon_.textContent = \"launch\";\n                        this.newTabButton_.appendChild(this.newTabIcon_);\n\n                        const label = document.createElement(\"label\");\n                        label.classList.add(\"shaka-overflow-button-label\");\n                        label.classList.add(\"shaka-overflow-menu-only\");\n                        this.newTabNameSpan_ = document.createElement(\"span\");\n                        this.newTabNameSpan_.innerText = \"Open in new tab\";\n                        label.appendChild(this.newTabNameSpan_);\n\n                        this.newTabButton_.appendChild(label);\n                        this.parent.appendChild(this.newTabButton_);\n\n                        this.eventManager.listen(this.newTabButton_, \"click\", () => {\n                            this.video.pause();\n                            window.open(url);\n                        });\n                    }\n                };\n\n                OpenButton.Factory = class {\n                    create(rootElement, controls) {\n                        return new OpenButton(rootElement, controls);\n                    }\n                };\n\n                shaka.ui.OverflowMenu.registerElement(\"open_new_tab\", new OpenButton.Factory());\n\n                this.$ui = new shaka.ui.Overlay(localPlayer, this.$refs.container, videoEl);\n\n                const overflowMenuButtons = [\"quality\", \"captions\", \"picture_in_picture\", \"playback_rate\", \"airplay\"];\n\n                if (this.isEmbed) {\n                    overflowMenuButtons.push(\"open_new_tab\");\n                }\n\n                const config = {\n                    overflowMenuButtons: overflowMenuButtons,\n                    seekBarColors: {\n                        base: \"var(--player-base)\",\n                        buffered: \"var(--player-buffered)\",\n                        played: \"var(--player-played)\",\n                    },\n                };\n\n                this.$ui.configure(config);\n            }\n\n            this.updateMarkers();\n\n            const event = new Event(\"playerInit\");\n            window.dispatchEvent(event);\n\n            const player = this.$ui.getControls().getPlayer();\n\n            this.setupSeekbarPreview();\n\n            this.$player = player;\n\n            const disableVideo = this.getPreferenceBoolean(\"listen\", false) && !this.video.livestream;\n\n            const prefetchLimit = Math.min(Math.max(this.getPreferenceNumber(\"prefetchLimit\", 2), 0), 10);\n\n            this.$player.configure({\n                preferredVideoCodecs: this.preferredVideoCodecs,\n                preferredAudioCodecs: [\"opus\", \"mp4a\"],\n                manifest: {\n                    disableVideo: disableVideo,\n                },\n                streaming: {\n                    segmentPrefetchLimit: prefetchLimit,\n                    retryParameters: {\n                        maxAttempts: Infinity,\n                        baseDelay: 250,\n                        backoffFactor: 1.5,\n                    },\n                },\n            });\n\n            const quality = this.getPreferenceNumber(\"quality\", 0);\n            const qualityConds =\n                quality > 0 && (this.video.audioStreams.length > 0 || this.video.livestream) && !disableVideo;\n            if (qualityConds) this.$player.configure(\"abr.enabled\", false);\n\n            const time = this.$route.query.t ?? this.$route.query.start;\n\n            var startTime = 0;\n\n            if (time) {\n                startTime = parseTimeParam(time);\n                this.initialSeekComplete = true;\n            } else if (window.db && this.getPreferenceBoolean(\"watchHistory\", false)) {\n                await new Promise(resolve => {\n                    var tx = window.db.transaction(\"watch_history\", \"readonly\");\n                    var store = tx.objectStore(\"watch_history\");\n                    var request = store.get(this.video.id);\n                    request.onsuccess = function (event) {\n                        var video = event.target.result;\n                        const currentTime = video?.currentTime;\n                        if (currentTime) {\n                            if (currentTime < video.duration * 0.9) {\n                                startTime = currentTime;\n                            }\n                        }\n                        resolve();\n                    };\n\n                    tx.oncomplete = () => {\n                        this.initialSeekComplete = true;\n                    };\n                });\n            } else {\n                this.initialSeekComplete = true;\n            }\n\n            player\n                .load(uri, startTime, mime)\n                .then(() => {\n                    const isSafari = window.navigator?.vendor?.includes(\"Apple\");\n\n                    if (!isSafari) {\n                        // Set the audio language\n                        const prefLang = this.getPreferenceString(\"hl\", \"en\").substr(0, 2);\n                        var lang = \"en\";\n                        for (var l in player.getAudioLanguages()) {\n                            if (l == prefLang) {\n                                lang = l;\n                                return;\n                            }\n                        }\n                        player.selectAudioLanguage(lang);\n                    }\n\n                    const audioLanguages = player.getAudioLanguages();\n                    if (audioLanguages.length > 1) {\n                        const overflowMenuButtons = this.$ui.getConfiguration().overflowMenuButtons;\n                        // append language menu on index 1\n                        const newOverflowMenuButtons = [\n                            ...overflowMenuButtons.slice(0, 1),\n                            \"language\",\n                            ...overflowMenuButtons.slice(1),\n                        ];\n                        this.$ui.configure(\"overflowMenuButtons\", newOverflowMenuButtons);\n                    }\n\n                    if (qualityConds) {\n                        var leastDiff = Number.MAX_VALUE;\n                        var bestStream = null;\n\n                        var bestAudio = 0;\n\n                        const tracks = player\n                            .getVariantTracks()\n                            .filter(track => track.language == lang || track.language == \"und\");\n\n                        // Choose the best audio stream\n                        if (quality >= 480)\n                            tracks.forEach(track => {\n                                const audioBandwidth = track.audioBandwidth;\n                                if (audioBandwidth > bestAudio) bestAudio = audioBandwidth;\n                            });\n\n                        // Find best matching stream based on resolution and bitrate\n                        tracks\n                            .sort((a, b) => a.bandwidth - b.bandwidth)\n                            .forEach(stream => {\n                                if (stream.audioBandwidth < bestAudio) return;\n\n                                const diff = Math.abs(quality - stream.height);\n                                if (diff < leastDiff) {\n                                    leastDiff = diff;\n                                    bestStream = stream;\n                                }\n                            });\n\n                        player.selectVariantTrack(bestStream, true);\n                    }\n\n                    this.video.subtitles.map(subtitle => {\n                        player.addTextTrackAsync(\n                            subtitle.url,\n                            subtitle.code,\n                            \"subtitles\",\n                            subtitle.mimeType,\n                            null,\n                            subtitle.name,\n                        );\n                    });\n                    videoEl.volume = this.getPreferenceNumber(\"volume\", 1);\n                    const rate = this.getPreferenceNumber(\"rate\", 1);\n                    videoEl.playbackRate = rate;\n                    videoEl.defaultPlaybackRate = rate;\n\n                    const autoDisplayCaptions = this.getPreferenceBoolean(\"autoDisplayCaptions\", false);\n                    this.$player.setTextTrackVisibility(autoDisplayCaptions);\n\n                    const prefSubtitles = this.getPreferenceString(\"subtitles\", \"\");\n                    if (prefSubtitles !== \"\") {\n                        const textTracks = this.$player.getTextTracks();\n                        const subtitleIdx = textTracks.findIndex(textTrack => textTrack.language == prefSubtitles);\n                        if (subtitleIdx != -1) {\n                            this.$player.setTextTrackVisibility(true);\n                            this.$player.selectTextTrack(textTracks[subtitleIdx]);\n                        }\n                    }\n                })\n                .catch(e => {\n                    console.error(e);\n                    this.error = e.code;\n                });\n\n            // expand the player to fullscreen when the fullscreen query equals true\n            if (this.$route.query.fullscreen === \"true\" && !this.$ui.getControls().isFullScreenEnabled())\n                this.$ui.getControls().toggleFullScreen();\n\n            const seekbar = this.$refs.container.querySelector(\".shaka-seek-bar\");\n            const array = [\"to right\"];\n            for (const chapter of this.video.chapters) {\n                const start = (chapter.start / this.video.duration) * 100;\n                if (start === 0) {\n                    continue;\n                }\n                array.push(`transparent ${start}%`);\n                array.push(`black ${start}%`);\n                array.push(`black calc(${start}% + 1px)`);\n                array.push(`transparent calc(${start}% + 1px)`);\n            }\n            seekbar.style.background = `linear-gradient(${array.join(\",\")})`;\n\n            seekbar.addEventListener(\"mouseup\", () => {\n                this.$refs.videoEl.focus();\n            });\n        },\n        async updateProgressDatabase(time) {\n            // debounce\n            if (new Date().getTime() - this.lastUpdate < 500) return;\n            this.lastUpdate = new Date().getTime();\n\n            if (!this.initialSeekComplete || !this.video.id || !window.db) return;\n\n            var tx = window.db.transaction(\"watch_history\", \"readwrite\");\n            var store = tx.objectStore(\"watch_history\");\n            var request = store.get(this.video.id);\n            request.onsuccess = function (event) {\n                var video = event.target.result;\n                if (video) {\n                    video.currentTime = time;\n                    store.put(video);\n                }\n            };\n        },\n        seek(time) {\n            if (this.$refs.videoEl) {\n                this.$refs.videoEl.currentTime = time;\n            }\n        },\n        adjustPlaybackSpeed(newSpeed) {\n            const normalizedSpeed = Math.min(4, Math.max(0.25, newSpeed));\n            this.$player.trickPlay(normalizedSpeed);\n            if (this.hideCurrentSpeed) window.clearTimeout(this.hideCurrentSpeed);\n            this.showCurrentSpeed = false;\n            this.showCurrentSpeed = true;\n            this.hideCurrentSpeed = window.setTimeout(() => (this.showCurrentSpeed = false), 1500);\n        },\n        adjustPlaybackVolume(newVolume) {\n            const normalizedVolume = Math.min(1, Math.max(0, newVolume));\n            this.$refs.videoEl.volume = normalizedVolume;\n            if (this.hideCurrentVolume) window.clearTimeout(this.hideCurrentVolume);\n            this.showCurrentVolume = false;\n            this.showCurrentVolume = true;\n            this.hideCurrentVolume = window.setTimeout(() => (this.showCurrentVolume = false), 1500);\n        },\n        setSpeedFromInput() {\n            try {\n                const newSpeed = Number(this.playbackSpeedInput);\n                this.adjustPlaybackSpeed(newSpeed);\n            } catch (err) {\n                alert(this.$t(\"actions.invalid_input\"));\n            }\n            this.showSpeedModal = false;\n        },\n        updateMarkers() {\n            const markers = this.$refs.container.querySelector(\".shaka-ad-markers\");\n            const array = [\"to right\"];\n            this.sponsors?.segments?.forEach(segment => {\n                const start = (segment.segment[0] / this.video.duration) * 100;\n                const end = (segment.segment[1] / this.video.duration) * 100;\n\n                var color = [\n                    \"sponsor\",\n                    \"selfpromo\",\n                    \"interaction\",\n                    \"poi_highlight\",\n                    \"intro\",\n                    \"outro\",\n                    \"preview\",\n                    \"filler\",\n                    \"music_offtopic\",\n                ].includes(segment.category)\n                    ? `var(--spon-seg-${segment.category})`\n                    : \"var(--spon-seg-default)\";\n\n                array.push(`transparent ${start}%`);\n                array.push(`${color} ${start}%`);\n                array.push(`${color} ${end}%`);\n                array.push(`transparent ${end}%`);\n            });\n\n            if (array.length <= 1) {\n                return;\n            }\n\n            if (markers) markers.style.background = `linear-gradient(${array.join(\",\")})`;\n        },\n        updateSponsors() {\n            if (this.getPreferenceBoolean(\"showMarkers\", true)) {\n                this.shakaPromise.then(() => {\n                    this.updateMarkers();\n                });\n            }\n        },\n        setupSeekbarPreview() {\n            if (!this.video.previewFrames) return;\n            let seekBar = document.querySelector(\".shaka-seek-bar\");\n            // load the thumbnail preview when the user moves over the seekbar\n            seekBar.addEventListener(\"mousemove\", e => {\n                this.isHoveringTimebar = true;\n                const position = (e.offsetX / e.target.offsetWidth) * this.video.duration;\n                this.showSeekbarPreview(position * 1000);\n            });\n            // hide the preview when the user stops hovering the seekbar\n            seekBar.addEventListener(\"mouseout\", () => {\n                this.isHoveringTimebar = false;\n                this.$refs.previewContainer.style.display = \"none\";\n            });\n        },\n        async showSeekbarPreview(position) {\n            const frame = this.getFrame(position);\n            const originalImage = await this.loadImage(frame.url);\n            if (!this.isHoveringTimebar) return;\n\n            const seekBar = document.querySelector(\".shaka-seek-bar\");\n            const container = this.$refs.previewContainer;\n            const canvas = this.$refs.preview;\n            const ctx = canvas.getContext(\"2d\");\n\n            const offsetX = frame.positionX * frame.frameWidth;\n            const offsetY = frame.positionY * frame.frameHeight;\n\n            canvas.width = frame.frameWidth > 100 ? frame.frameWidth : frame.frameWidth * 2;\n            canvas.height = frame.frameWidth > 100 ? frame.frameHeight : frame.frameHeight * 2;\n            // draw the thumbnail preview into the canvas by cropping only the relevant part\n            ctx.drawImage(\n                originalImage,\n                offsetX,\n                offsetY,\n                frame.frameWidth,\n                frame.frameHeight,\n                0,\n                0,\n                canvas.width,\n                canvas.height,\n            );\n\n            // calculate the thumbnail preview offset and display it\n            const centerOffset = position / this.video.duration / 10;\n            const left = centerOffset - ((0.5 * canvas.width) / seekBar.clientWidth) * 100;\n            const maxLeft =\n                ((seekBar.clientWidth - canvas.clientWidth) / seekBar.clientWidth) * 100 - this.seekbarPadding;\n\n            this.currentTime = position / 1000;\n\n            container.style.left = `max(${this.seekbarPadding}%, min(${left}%, ${maxLeft}%))`;\n            container.style.display = \"flex\";\n        },\n        // ineffective algorithm to find the thumbnail corresponding to the currently hovered position in the video\n        getFrame(position) {\n            let startPosition = 0;\n            const framePage = this.video.previewFrames.at(-1);\n            for (let i = 0; i < framePage.urls.length; i++) {\n                for (let positionY = 0; positionY < framePage.framesPerPageY; positionY++) {\n                    for (let positionX = 0; positionX < framePage.framesPerPageX; positionX++) {\n                        const endPosition = startPosition + framePage.durationPerFrame;\n                        if (position >= startPosition && position <= endPosition) {\n                            return {\n                                url: framePage.urls[i],\n                                positionX: positionX,\n                                positionY: positionY,\n                                frameWidth: framePage.frameWidth,\n                                frameHeight: framePage.frameHeight,\n                            };\n                        }\n                        startPosition = endPosition;\n                    }\n                }\n            }\n            return null;\n        },\n        // creates a new image from an URL\n        loadImage(url) {\n            return new Promise(r => {\n                const i = new Image();\n                i.onload = () => r(i);\n                i.src = url;\n            });\n        },\n        destroy(hotkeys) {\n            if (this.$ui && !document.pictureInPictureElement) {\n                this.$ui.destroy();\n                this.$ui = undefined;\n                this.$player = undefined;\n            }\n            if (this.$player) {\n                this.$player.destroy();\n                if (!document.pictureInPictureElement) this.$player = undefined;\n            }\n            if (hotkeys) this.$hotkeys?.unbind();\n            this.$refs.container?.querySelectorAll(\"div\").forEach(node => node.remove());\n        },\n    },\n};\n</script>\n\n<style>\n:root {\n    --player-base: rgba(255, 255, 255, 0.3);\n    --player-buffered: rgba(255, 255, 255, 0.54);\n    --player-played: rgba(255, 0, 0);\n\n    --spon-seg-sponsor: #00d400;\n    --spon-seg-selfpromo: #ffff00;\n    --spon-seg-interaction: #cc00ff;\n    --spon-seg-poi_highlight: #ff1684;\n    --spon-seg-intro: #00ffff;\n    --spon-seg-outro: #0202ed;\n    --spon-seg-preview: #008fd6;\n    --spon-seg-filler: #7300ff;\n    --spon-seg-music_offtopic: #ff9900;\n    --spon-seg-default: white;\n}\n\n.player-container {\n    @apply max-h-75vh min-h-64 bg-black;\n}\n\n.shaka-video-container .material-icons-round {\n    @apply !text-xl;\n}\n\n.shaka-current-time {\n    @apply !text-base;\n}\n\n.shaka-video-container:-webkit-full-screen {\n    max-height: none !important;\n}\n\n/* captions style */\n.shaka-text-wrapper * {\n    text-align: left !important;\n}\n\n.shaka-text-wrapper > span > span {\n    background-color: transparent !important;\n}\n\n/* apply to all spans that don't include multiple other spans to avoid the style being applied to the text container too when the subtitles are two lines */\n.shaka-text-wrapper > span > span *:first-child:last-child {\n    background-color: rgba(0, 0, 0, 0.6) !important;\n    padding: 0.09em 0;\n}\n\n#shaka-player-ui-time-container {\n    display: none !important;\n}\n\n.skip-segment-button {\n    /* position button above player overlay */\n    z-index: 1000;\n\n    position: absolute;\n    transform: translate(0, -50%);\n    top: 50%;\n    right: 0;\n\n    background-color: rgb(0 0 0 / 0.5);\n    border: 2px rgba(255, 255, 255, 0.75) solid;\n    border-right: 0;\n    border-radius: 0.75em;\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n    padding: 0.5em;\n\n    /* center text vertically */\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    color: #fff;\n    line-height: 1.5em;\n}\n\n.skip-segment-button .material-icons-round {\n    font-size: 1.6em !important;\n    line-height: inherit !important;\n}\n</style>\n","<template>\n    <div class=\"comment mt-1.5 flex\">\n        <img\n            loading=\"lazy\"\n            :src=\"comment.thumbnail\"\n            class=\"comment-avatar h-12 w-12 rounded-full\"\n            height=\"48\"\n            width=\"48\"\n            alt=\"Avatar\"\n        />\n\n        <div class=\"comment-content pl-2\">\n            <div class=\"comment-header\">\n                <div v-if=\"comment.pinned\" class=\"comment-pinned\">\n                    <i class=\"i-fa6-solid:thumbtack\" />\n                    <span\n                        v-t=\"{\n                            path: 'comment.pinned_by',\n                            args: { author: uploader },\n                        }\"\n                        class=\"ml-1.5\"\n                    />\n                </div>\n\n                <div class=\"comment-author\">\n                    <router-link class=\"link font-bold\" :to=\"comment.commentorUrl\">{{ comment.author }}</router-link>\n                    <i v-if=\"comment.verified\" class=\"i-fa6-solid:check ml-1.5\" />\n                </div>\n                <div class=\"comment-meta mb-1.5 text-sm\" v-text=\"comment.commentedTime\" />\n            </div>\n            <!-- eslint-disable-next-line vue/no-v-html -->\n            <CollapsableText :text=\"comment.commentText\" :visible-limit=\"500\" />\n            <div class=\"comment-footer my-1 flex items-center gap-3\">\n                <div class=\"i-fa6-solid:thumbs-up\" />\n                <span v-text=\"numberFormat(comment.likeCount)\" />\n                <i v-if=\"comment.hearted\" class=\"i-fa6-solid:heart\" :title=\"$t('actions.creator_liked')\" />\n                <img\n                    v-if=\"comment.creatorReplied\"\n                    :src=\"uploaderAvatarUrl\"\n                    class=\"h-5 w-5 rounded-full\"\n                    :title=\"$t('actions.creator_replied')\"\n                />\n            </div>\n            <template v-if=\"comment.repliesPage && (!loadingReplies || !showingReplies)\">\n                <div class=\"cursor-pointer\" @click=\"loadReplies\">\n                    <a v-text=\"`${$t('actions.reply_count', comment.replyCount)}`\" />\n                    <i class=\"i-fa6-solid:level-down-alt ml-1.5\" />\n                </div>\n            </template>\n            <template v-if=\"showingReplies\">\n                <div class=\"cursor-pointer\" @click=\"hideReplies\">\n                    <a v-t=\"'actions.hide_replies'\" />\n                    <i class=\"i-fa6-solid:level-up-alt ml-1.5\" />\n                </div>\n            </template>\n            <div v-show=\"showingReplies\" v-if=\"replies\" class=\"replies\">\n                <div v-for=\"reply in replies\" :key=\"reply.commentId\" class=\"w-full\">\n                    <!-- eslint-disable-next-line vue/no-undef-components -->\n                    <CommentItem :comment=\"reply\" :uploader=\"uploader\" :video-id=\"videoId\" />\n                </div>\n                <div v-if=\"nextpage\" class=\"cursor-pointer\" @click=\"loadReplies\">\n                    <a v-t=\"'actions.load_more_replies'\" />\n                    <i class=\"i-fa6-solid:level-down-alt ml-1.5\" />\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport CollapsableText from \"./CollapsableText.vue\";\n\nexport default {\n    components: { CollapsableText },\n    props: {\n        comment: {\n            type: Object,\n            default: () => {\n                return {};\n            },\n        },\n        uploader: { type: String, default: null },\n        uploaderAvatarUrl: { type: String, default: null },\n        videoId: { type: String, default: null },\n    },\n    data() {\n        return {\n            loadingReplies: false,\n            showingReplies: false,\n            replies: [],\n            nextpage: null,\n        };\n    },\n    methods: {\n        async loadReplies() {\n            console.log(this.uploaderAvatarUrl);\n            if (!this.showingReplies && this.loadingReplies) {\n                this.showingReplies = true;\n                return;\n            }\n            this.loadingReplies = true;\n            this.showingReplies = true;\n            this.fetchJson(this.apiUrl() + \"/nextpage/comments/\" + this.videoId, {\n                nextpage: this.nextpage || this.comment.repliesPage,\n            }).then(json => {\n                this.replies = this.replies.concat(json.comments);\n                this.nextpage = json.nextpage;\n            });\n        },\n        async hideReplies() {\n            this.showingReplies = false;\n        },\n    },\n};\n</script>\n","<template>\n    <!-- desktop view -->\n    <div v-if=\"!mobileLayout\" class=\"max-h-75vh max-w-35vw min-h-64 flex-col overflow-y-scroll lt-lg:hidden\">\n        <h2 class=\"mb-2 bg-gray-500/50 p-2\" aria-label=\"chapters\" title=\"chapters\">\n            {{ $t(\"video.chapters\") }} ({{ chapters.length }})\n        </h2>\n        <div\n            v-for=\"(chapter, index) in chapters\"\n            :key=\"chapter.start\"\n            class=\"chapter-vertical\"\n            :class=\"{ 'bg-red-500/50': isCurrentChapter(index) }\"\n            @click=\"$emit('seek', chapter.start)\"\n        >\n            <div class=\"flex\">\n                <span class=\"mr-2 mt-5 text-current\" v-text=\"index + 1\" />\n                <img class=\"shrink-0\" :src=\"chapter.image\" :alt=\"chapter.title\" />\n                <div class=\"m-2 flex flex-col\">\n                    <span class=\"text-sm\" :title=\"chapter.title\" v-text=\"chapter.title\" />\n                    <span class=\"text-sm text-blue-500 font-bold\" v-text=\"timeFormat(chapter.start)\" />\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- mobile vertical view -->\n    <div\n        v-if=\"mobileLayout && getPreferenceString('mobileChapterLayout') == 'Vertical'\"\n        class=\"max-h-64 flex flex-col overflow-y-scroll\"\n    >\n        <h2 class=\"mb-2 bg-gray-500/50 p-2\" aria-label=\"chapters\" title=\"chapters\">\n            {{ $t(\"video.chapters\") }} ({{ chapters.length }})\n        </h2>\n        <div\n            v-for=\"(chapter, index) in chapters\"\n            :key=\"chapter.start\"\n            class=\"chapter-vertical\"\n            :class=\"{ 'bg-red-500/50': isCurrentChapter(index) }\"\n            @click=\"$emit('seek', chapter.start)\"\n        >\n            <div class=\"flex\">\n                <span class=\"mr-2 mt-5 text-current\" v-text=\"index + 1\" />\n                <img class=\"shrink-0\" :src=\"chapter.image\" :alt=\"chapter.title\" />\n                <div class=\"m-2 flex flex-col\">\n                    <span class=\"text-sm\" :title=\"chapter.title\" v-text=\"chapter.title\" />\n                    <span class=\"text-sm text-blue-500 font-bold\" v-text=\"timeFormat(chapter.start)\" />\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- mobile Horizontal view -->\n    <div v-if=\"getPreferenceString('mobileChapterLayout') == 'Horizontal' && mobileLayout\" class=\"flex overflow-x-auto\">\n        <div\n            v-for=\"(chapter, index) in chapters\"\n            :key=\"chapter.start\"\n            class=\"chapter\"\n            :class=\"{ 'bg-red-500/50': isCurrentChapter(index) }\"\n            @click=\"$emit('seek', chapter.start)\"\n        >\n            <img :src=\"chapter.image\" :alt=\"chapter.title\" />\n            <div class=\"m-1 flex\">\n                <span class=\"text-truncate text-sm\" :title=\"chapter.title\" v-text=\"chapter.title\" />\n                <span class=\"px-1 text-sm text-blue-500 font-bold\" v-text=\"timeFormat(chapter.start)\" />\n            </div>\n        </div>\n    </div>\n</template>\n\n<script setup>\nconst props = defineProps({\n    chapters: {\n        type: Object,\n        default: () => null,\n    },\n    mobileLayout: {\n        type: Boolean,\n        default: () => true,\n    },\n    playerPosition: {\n        type: Number,\n        default: () => 0,\n    },\n});\n\nconst isCurrentChapter = index => {\n    return (\n        props.playerPosition >= props.chapters[index].start &&\n        props.playerPosition < (props.chapters[index + 1]?.start ?? Infinity)\n    );\n};\n\ndefineEmits([\"seek\"]);\n</script>\n\n<style>\n::-webkit-scrollbar {\n    height: 5px;\n}\n.chapter {\n    @apply cursor-pointer self-center p-2.5;\n}\n.chapter img {\n    @apply w-full h-full;\n}\n.chapter-vertical {\n    @apply cursor-pointer self-center p-2.5;\n}\n.chapter-vertical img {\n    @apply w-3/10 h-3/10;\n}\n\n.chapter-vertical:hover {\n    @apply bg-gray-500;\n}\n.text-truncate {\n    @apply truncate overflow-hidden inline-block w-10em;\n}\n</style>\n","<template>\n    <div ref=\"scrollable\" class=\"h-screen-sm overflow-x-scroll\">\n        <VideoItem\n            v-for=\"(related, index) in playlist.relatedStreams\"\n            :key=\"related.url\"\n            :item=\"related\"\n            :index=\"index\"\n            :playlist-id=\"playlistId\"\n            :prefer-listen=\"preferListen\"\n            height=\"94\"\n            width=\"168\"\n        />\n    </div>\n</template>\n\n<script>\nimport { nextTick } from \"vue\";\nimport VideoItem from \"./VideoItem.vue\";\n\nexport default {\n    components: { VideoItem },\n    props: {\n        playlist: {\n            type: Object,\n            required: true,\n        },\n        playlistId: {\n            type: String,\n            required: true,\n        },\n        selectedIndex: {\n            type: Number,\n            required: true,\n        },\n        preferListen: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    watch: {\n        playlist: {\n            handler() {\n                if (this.selectedIndex - 1 < this.playlist.relatedStreams.length)\n                    nextTick(() => {\n                        this.updateScroll();\n                    });\n            },\n            deep: true,\n        },\n    },\n    mounted() {\n        this.updateScroll();\n        this.updateWatched(this.playlist.relatedStreams);\n    },\n    methods: {\n        updateScroll() {\n            const elems = Array.from(this.$refs.scrollable.children).filter(elm => elm.matches(\"div\"));\n            const index = this.selectedIndex - 1;\n            if (index < elems.length)\n                this.$refs.scrollable.scrollTop =\n                    elems[this.selectedIndex - 1].offsetTop - this.$refs.scrollable.offsetTop;\n        },\n    },\n};\n</script>\n","<template>\n    <div class=\"toast\">\n        <slot />\n        <button v-t=\"'actions.dismiss'\" @click=\"dismiss\" />\n    </div>\n</template>\n\n<script>\nexport default {\n    emits: [\"dismissed\"],\n    methods: {\n        dismiss() {\n            this.$emit(\"dismissed\");\n        },\n    },\n};\n</script>\n\n<style>\n.toast {\n    @apply bg-white/80 text-black flex flex-col justify-center fixed top-12 right-12 p-4 min-w-max shadow rounded duration-200 z-9999;\n}\n.dark .toast {\n    @apply bg-dark-900/80 text-white;\n}\n.toast button {\n    @apply underline;\n}\n</style>\n","<template>\n    <div v-if=\"video && isEmbed\" class=\"absolute left-0 top-0 z-50 h-full w-full bg-black\">\n        <VideoPlayer\n            ref=\"videoPlayer\"\n            :video=\"video\"\n            :sponsors=\"sponsors\"\n            :selected-auto-play=\"false\"\n            :selected-auto-loop=\"selectedAutoLoop\"\n            :is-embed=\"isEmbed\"\n        />\n    </div>\n\n    <LoadingIndicatorPage :show-content=\"video && !isEmbed\" class=\"w-full\">\n        <ErrorHandler v-if=\"video && video.error\" :message=\"video.message\" :error=\"video.error\" />\n        <Transition>\n            <ToastComponent v-if=\"shouldShowToast\" @dismissed=\"dismiss\">\n                <i18n-t keypath=\"info.next_video_countdown\">{{ counter }}</i18n-t>\n            </ToastComponent>\n        </Transition>\n\n        <div v-show=\"!video.error\">\n            <div :class=\"isMobile ? 'flex-col' : 'flex'\">\n                <keep-alive>\n                    <VideoPlayer\n                        ref=\"videoPlayer\"\n                        :video=\"video\"\n                        :sponsors=\"sponsors\"\n                        :selected-auto-play=\"selectedAutoPlay\"\n                        :selected-auto-loop=\"selectedAutoLoop\"\n                        @timeupdate=\"onTimeUpdate\"\n                        @ended=\"onVideoEnded\"\n                        @navigate-next=\"navigateNext\"\n                    />\n                </keep-alive>\n                <ChaptersBar\n                    v-if=\"video?.chapters?.length > 0 && showChapters\"\n                    :mobile-layout=\"isMobile\"\n                    :chapters=\"video.chapters\"\n                    :player-position=\"currentTime\"\n                    @seek=\"navigate\"\n                />\n            </div>\n            <!-- video title -->\n            <div class=\"mt-2 break-words text-2xl font-bold\" v-text=\"video.title\" />\n            <div class=\"mb-3 mt-3 flex flex-wrap\">\n                <!-- views / date -->\n                <div class=\"flex flex-auto gap-2\">\n                    <span v-t=\"{ path: 'video.views', args: { views: addCommas(video.views) } }\" />\n                    <span> | </span>\n                    <span v-text=\"uploadDate\" />\n                </div>\n                <!-- Likes/dilikes -->\n                <div class=\"flex gap-2\">\n                    <template v-if=\"video.likes >= 0\">\n                        <div class=\"flex items-center\">\n                            <div class=\"i-fa6-solid:thumbs-up\" />\n                            <strong class=\"ml-1\" v-text=\"addCommas(video.likes)\" />\n                        </div>\n                        <div class=\"flex items-center\">\n                            <div class=\"i-fa6-solid:thumbs-down\" />\n                            <strong class=\"ml-1\" v-text=\"video.dislikes >= 0 ? addCommas(video.dislikes) : '?'\" />\n                        </div>\n                    </template>\n                    <template v-if=\"video.likes < 0\">\n                        <div>\n                            <strong v-t=\"'video.ratings_disabled'\" />\n                        </div>\n                    </template>\n                </div>\n            </div>\n            <!-- Channel info & options flex container -->\n            <div class=\"flex flex-wrap gap-1\">\n                <!-- Channel Image & Info -->\n                <div class=\"flex items-center\">\n                    <img\n                        loading=\"lazy\"\n                        height=\"48\"\n                        width=\"48\"\n                        :src=\"video.uploaderAvatar\"\n                        alt=\"\"\n                        class=\"rounded-full\"\n                    />\n                    <router-link v-if=\"video.uploaderUrl\" class=\"link ml-1.5\" :to=\"video.uploaderUrl\">{{\n                        video.uploader\n                    }}</router-link>\n                    <!-- Verified Badge -->\n                    <i v-if=\"video.uploaderVerified\" class=\"i-fa6-solid:check ml-1\" />\n                </div>\n                <PlaylistAddModal\n                    v-if=\"showModal\"\n                    :video-id=\"getVideoId()\"\n                    :video-info=\"video\"\n                    @close=\"showModal = !showModal\"\n                />\n                <ShareModal\n                    v-if=\"showShareModal\"\n                    :video-id=\"getVideoId()\"\n                    :current-time=\"currentTime\"\n                    :playlist-id=\"playlistId\"\n                    :playlist-index=\"index\"\n                    @close=\"showShareModal = !showShareModal\"\n                />\n                <div class=\"ml-auto flex flex-wrap gap-1\">\n                    <!-- Subscribe Button -->\n                    <button class=\"btn flex items-center gap-1 <md:hidden\" @click=\"downloadCurrentFrame\">\n                        {{ $t(\"actions.download_frame\") }}<i class=\"i-fa6-solid:download\" />\n                    </button>\n                    <button class=\"btn flex items-center\" @click=\"showModal = !showModal\">\n                        {{ $t(\"actions.add_to_playlist\") }}<i class=\"i-fa6-solid:circle-plus ml-1\" />\n                    </button>\n                    <button\n                        class=\"btn\"\n                        @click=\"subscribeHandler\"\n                        v-text=\"\n                            $t('actions.' + (subscribed ? 'unsubscribe' : 'subscribe')) +\n                            ' - ' +\n                            numberFormat(video.uploaderSubscriberCount)\n                        \"\n                    />\n                    <div class=\"flex flex-wrap gap-1\">\n                        <!-- RSS Feed button -->\n                        <a\n                            v-if=\"video.uploaderUrl\"\n                            aria-label=\"RSS feed\"\n                            title=\"RSS feed\"\n                            role=\"button\"\n                            :href=\"`${apiUrl()}/feed/unauthenticated/rss?channels=${video.uploaderUrl.split('/')[2]}`\"\n                            target=\"_blank\"\n                            class=\"btn flex items-center\"\n                        >\n                            <i class=\"i-fa6-solid:rss mx-1.5\" />\n                        </a>\n                        <!-- Share Dialog -->\n                        <button class=\"btn flex items-center\" @click=\"showShareModal = !showShareModal\">\n                            <i18n-t class=\"lt-lg:hidden\" keypath=\"actions.share\" tag=\"strong\"></i18n-t>\n                            <i class=\"i-fa6-solid:share mx-1.5\" />\n                        </button>\n                        <!-- YouTube -->\n                        <WatchOnButton :link=\"youtubeVideoHref\" />\n                        <!-- Odysee -->\n                        <WatchOnButton\n                            v-if=\"video.lbryId\"\n                            :link=\"`https://odysee.com/${video.lbryId}`\"\n                            platform=\"Odysee\"\n                        />\n                        <!-- listen / watch toggle -->\n                        <router-link\n                            :to=\"toggleListenUrl\"\n                            :aria-label=\"(isListening ? 'Watch ' : 'Listen to ') + video.title\"\n                            :title=\"(isListening ? 'Watch ' : 'Listen to ') + video.title\"\n                            class=\"btn flex items-center\"\n                        >\n                            <i :class=\"isListening ? 'i-fa6-solid:tv' : 'i-fa6-solid:headphones'\" class=\"mx-1.5\" />\n                        </router-link>\n                    </div>\n                </div>\n            </div>\n\n            <hr class=\"mb-2\" />\n\n            <div\n                v-for=\"metaInfo in video?.metaInfo ?? []\"\n                :key=\"metaInfo.title\"\n                class=\"btn my-3 flex flex-wrap cursor-default gap-2 px-4 py-2\"\n            >\n                <span>{{ metaInfo.description ?? metaInfo.title }}</span>\n                <a v-for=\"(link, linkIndex) in metaInfo.urls\" :key=\"linkIndex\" :href=\"link\" class=\"underline\">{{\n                    metaInfo.urlTexts[linkIndex]\n                }}</a>\n                <br />\n            </div>\n\n            <button\n                v-t=\"`actions.${showDesc ? 'minimize_description' : 'show_description'}`\"\n                class=\"btn mb-2\"\n                @click=\"showDesc = !showDesc\"\n            />\n\n            <span v-show=\"video?.chapters?.length > 0\" class=\"btn ml-2\">\n                <input id=\"showChapters\" v-model=\"showChapters\" type=\"checkbox\" />\n                <label v-t=\"'actions.show_chapters'\" class=\"ml-2\" for=\"showChapters\" />\n            </span>\n\n            <template v-if=\"showDesc\">\n                <!-- eslint-disable-next-line vue/no-v-html -->\n                <div class=\"description break-words\" v-html=\"purifiedDescription\" />\n                <br />\n\n                <div\n                    v-if=\"sponsors && sponsors.segments\"\n                    v-text=\"`${$t('video.sponsor_segments')}: ${sponsors.segments.length}`\"\n                />\n                <div v-if=\"video.category\" v-text=\"`${$t('video.category')}: ${video.category}`\" />\n                <div v-text=\"`${$t('video.license')}: ${video.license}`\" />\n                <div class=\"capitalize\" v-text=\"`${$t('video.visibility')}: ${video.visibility}`\" />\n\n                <div v-if=\"video.tags\" class=\"mt-2 flex flex-wrap gap-2\">\n                    <router-link\n                        v-for=\"tag in video.tags\"\n                        :key=\"tag\"\n                        class=\"btn line-clamp-1 rounded-s px-2 py-1\"\n                        :to=\"`/results?search_query=${encodeURIComponent(tag)}`\"\n                        >{{ tag }}</router-link\n                    >\n                </div>\n            </template>\n        </div>\n\n        <hr />\n\n        <label for=\"chkAutoLoop\"><strong v-text=\"`${$t('actions.loop_this_video')}:`\" /></label>\n        <input id=\"chkAutoLoop\" v-model=\"selectedAutoLoop\" class=\"ml-1.5\" type=\"checkbox\" @change=\"onChange($event)\" />\n        <br />\n        <label for=\"chkAutoPlay\"><strong v-text=\"`${$t('actions.auto_play_next_video')}:`\" /></label>\n        <input id=\"chkAutoPlay\" v-model=\"selectedAutoPlay\" class=\"ml-1.5\" type=\"checkbox\" @change=\"onChange($event)\" />\n\n        <hr />\n\n        <div class=\"grid grid-cols-1 sm:grid-cols-4 xl:grid-cols-5\">\n            <div class=\"sm:col-span-3 xl:col-span-4\">\n                <button\n                    v-if=\"!comments?.disabled\"\n                    class=\"btn mb-2\"\n                    @click=\"toggleComments\"\n                    v-text=\"\n                        `${$t(showComments ? 'actions.minimize_comments' : 'actions.show_comments')} (${numberFormat(\n                            comments?.commentCount,\n                        )})`\n                    \"\n                />\n            </div>\n            <div v-if=\"!showComments\" class=\"sm:col-span-3 xl:col-span-4\"></div>\n            <div v-else-if=\"!comments\" class=\"sm:col-span-3 xl:col-span-4\">\n                <p v-t=\"'comment.loading'\" class=\"mt-8 text-center\"></p>\n            </div>\n            <div v-else-if=\"comments.disabled\" class=\"sm:col-span-3 xl:col-span-4\">\n                <p v-t=\"'comment.disabled'\" class=\"mt-8 text-center\"></p>\n            </div>\n            <div v-else ref=\"comments\" class=\"sm:col-span-3 xl:col-span-4\">\n                <CommentItem\n                    v-for=\"comment in comments.comments\"\n                    :key=\"comment.commentId\"\n                    :comment=\"comment\"\n                    :uploader=\"video.uploader\"\n                    :uploader-avatar-url=\"video.uploaderAvatar\"\n                    :video-id=\"getVideoId()\"\n                />\n            </div>\n\n            <div v-if=\"video\" class=\"order-first sm:order-last\">\n                <PlaylistVideos\n                    v-if=\"playlist\"\n                    :playlist-id=\"playlistId\"\n                    :playlist=\"playlist\"\n                    :selected-index=\"index\"\n                    :prefer-listen=\"isListening\"\n                />\n                <a\n                    v-t=\"`actions.${showRecs ? 'minimize_recommendations' : 'show_recommendations'}`\"\n                    class=\"btn mb-2\"\n                    @click=\"showRecs = !showRecs\"\n                />\n                <hr v-show=\"showRecs\" />\n                <div v-show=\"showRecs\">\n                    <ContentItem\n                        v-for=\"related in video.relatedStreams\"\n                        :key=\"related.url\"\n                        :item=\"related\"\n                        :prefer-listen=\"isListening\"\n                        class=\"mb-4\"\n                        height=\"94\"\n                        width=\"168\"\n                    />\n                </div>\n                <hr class=\"sm:hidden\" />\n            </div>\n        </div>\n    </LoadingIndicatorPage>\n</template>\n\n<script>\nimport VideoPlayer from \"./VideoPlayer.vue\";\nimport ContentItem from \"./ContentItem.vue\";\nimport ErrorHandler from \"./ErrorHandler.vue\";\nimport CommentItem from \"./CommentItem.vue\";\nimport ChaptersBar from \"./ChaptersBar.vue\";\nimport PlaylistAddModal from \"./PlaylistAddModal.vue\";\nimport ShareModal from \"./ShareModal.vue\";\nimport PlaylistVideos from \"./PlaylistVideos.vue\";\nimport WatchOnButton from \"./WatchOnButton.vue\";\nimport LoadingIndicatorPage from \"./LoadingIndicatorPage.vue\";\nimport ToastComponent from \"./ToastComponent.vue\";\nimport { parseTimeParam } from \"@/utils/Misc\";\nimport { purifyHTML, rewriteDescription } from \"@/utils/HtmlUtils\";\n\nexport default {\n    name: \"App\",\n    components: {\n        VideoPlayer,\n        ContentItem,\n        ErrorHandler,\n        CommentItem,\n        ChaptersBar,\n        PlaylistAddModal,\n        ShareModal,\n        PlaylistVideos,\n        WatchOnButton,\n        LoadingIndicatorPage,\n        ToastComponent,\n    },\n    data() {\n        const smallViewQuery = window.matchMedia(\"(max-width: 640px)\");\n        return {\n            video: null,\n            playlistId: null,\n            playlist: null,\n            index: null,\n            sponsors: null,\n            selectedAutoLoop: false,\n            selectedAutoPlay: null,\n            showComments: true,\n            showDesc: false,\n            showRecs: true,\n            showChapters: true,\n            comments: null,\n            subscribed: false,\n            channelId: null,\n            active: true,\n            smallViewQuery: smallViewQuery,\n            smallView: smallViewQuery.matches,\n            showModal: false,\n            showShareModal: false,\n            isMobile: true,\n            currentTime: 0,\n            shouldShowToast: false,\n            timeoutCounter: null,\n            counter: 0,\n        };\n    },\n    computed: {\n        isListening(_this) {\n            return _this.getPreferenceBoolean(\"listen\", false);\n        },\n        toggleListenUrl(_this) {\n            const url = new URL(window.location.href);\n            url.searchParams.set(\"listen\", _this.isListening ? \"0\" : \"1\");\n            url.searchParams.set(\"t\", Math.floor(this.currentTime));\n            return url.pathname + url.search;\n        },\n        isEmbed(_this) {\n            return String(_this.$route.path).indexOf(\"/embed/\") == 0;\n        },\n        uploadDate(_this) {\n            return new Date(_this.video.uploadDate).toLocaleString(undefined, {\n                month: \"short\",\n                day: \"numeric\",\n                year: \"numeric\",\n            });\n        },\n        defaultCounter(_this) {\n            return _this.getPreferenceNumber(\"autoPlayNextCountdown\", 5);\n        },\n        purifiedDescription() {\n            return purifyHTML(this.video.description);\n        },\n        youtubeVideoHref() {\n            let link = `https://youtu.be/${this.getVideoId()}?t=${Math.round(this.currentTime)}`;\n            if (this.playlistId) link += `&list=${this.playlistId}`;\n            return link;\n        },\n    },\n    mounted() {\n        // check screen size\n        if (window.innerWidth >= 1024) {\n            this.isMobile = false;\n        }\n        // add an event listener to watch for screen size changes\n        window.addEventListener(\"resize\", () => {\n            if (window.innerWidth >= 1024) {\n                this.isMobile = false;\n            } else {\n                this.isMobile = true;\n            }\n        });\n        this.getVideoData().then(() => {\n            (async () => {\n                const videoId = this.getVideoId();\n                const instance = this;\n                if (window.db && this.getPreferenceBoolean(\"watchHistory\", false) && !this.video.error) {\n                    var tx = window.db.transaction(\"watch_history\", \"readwrite\");\n                    var store = tx.objectStore(\"watch_history\");\n                    var request = store.get(videoId);\n                    request.onsuccess = function (event) {\n                        var video = event.target.result;\n                        if (video) {\n                            video.watchedAt = Date.now();\n                        } else {\n                            video = {\n                                videoId: videoId,\n                                title: instance.video.title,\n                                duration: instance.video.duration,\n                                thumbnail: instance.video.thumbnailUrl,\n                                uploaderUrl: instance.video.uploaderUrl,\n                                uploaderName: instance.video.uploader,\n                                watchedAt: Date.now(),\n                            };\n                        }\n                        store.put(video);\n                    };\n                }\n            })();\n            if (this.active) this.$refs.videoPlayer.loadVideo();\n        });\n        this.playlistId = this.$route.query.list;\n        this.index = Number(this.$route.query.index);\n        this.getPlaylistData();\n        this.getSponsors();\n        if (!this.isEmbed && this.showComments) this.getComments();\n        if (this.isEmbed) document.querySelector(\"html\").style.overflow = \"hidden\";\n        window.addEventListener(\"click\", this.handleClick);\n        window.addEventListener(\"resize\", () => {\n            this.smallView = this.smallViewQuery.matches;\n        });\n    },\n    activated() {\n        this.active = true;\n        this.selectedAutoPlay = this.getPreferenceBoolean(\"autoplay\", false);\n        this.showComments = !this.getPreferenceBoolean(\"minimizeComments\", false);\n        this.showDesc = !this.getPreferenceBoolean(\"minimizeDescription\", true);\n        this.showRecs = !this.getPreferenceBoolean(\"minimizeRecommendations\", false);\n        this.showChapters = !this.getPreferenceBoolean(\"minimizeChapters\", false);\n        if (this.video?.duration) {\n            document.title = this.video.title + \" - Piped\";\n            this.$refs.videoPlayer.loadVideo();\n        }\n        window.addEventListener(\"scroll\", this.handleScroll);\n    },\n    deactivated() {\n        this.active = false;\n        window.removeEventListener(\"scroll\", this.handleScroll);\n        this.dismiss();\n    },\n    unmounted() {\n        window.removeEventListener(\"scroll\", this.handleScroll);\n        window.removeEventListener(\"click\", this.handleClick);\n        this.dismiss();\n    },\n    methods: {\n        fetchVideo() {\n            return this.fetchJson(this.apiUrl() + \"/streams/\" + this.getVideoId());\n        },\n        async fetchSponsors() {\n            var selectedSkip = this.getPreferenceString(\n                \"selectedSkip\",\n                \"sponsor,interaction,selfpromo,music_offtopic\",\n            ).split(\",\");\n            const skipOptions = this.getPreferenceJSON(\"skipOptions\");\n            if (skipOptions !== undefined) {\n                selectedSkip = Object.keys(skipOptions).filter(\n                    k => skipOptions[k] !== undefined && skipOptions[k] !== \"no\",\n                );\n            }\n\n            const sponsors = await this.fetchJson(this.apiUrl() + \"/sponsors/\" + this.getVideoId(), {\n                category: JSON.stringify(selectedSkip),\n            });\n\n            sponsors?.segments?.forEach(segment => {\n                const option = skipOptions?.[segment.category];\n                segment.autoskip = option === undefined || option === \"auto\";\n            });\n\n            const minSegmentLength = Math.max(this.getPreferenceNumber(\"minSegmentLength\", 0), 0);\n            sponsors.segments = sponsors.segments?.filter(segment => {\n                const length = segment.segment[1] - segment.segment[0];\n                return length >= minSegmentLength;\n            });\n\n            return sponsors;\n        },\n        toggleComments() {\n            this.showComments = !this.showComments;\n            if (this.showComments && this.comments === null) {\n                this.fetchComments();\n            }\n        },\n        fetchComments() {\n            return this.fetchJson(this.apiUrl() + \"/comments/\" + this.getVideoId());\n        },\n        onChange() {\n            this.setPreference(\"autoplay\", this.selectedAutoPlay, true);\n        },\n        async getVideoData() {\n            await this.fetchVideo()\n                .then(data => {\n                    this.video = data;\n                    this.video.id = this.getVideoId();\n                })\n                .then(() => {\n                    if (!this.video.error) {\n                        document.title = this.video.title + \" - Piped\";\n                        this.channelId = this.video.uploaderUrl.split(\"/\")[2];\n                        if (!this.isEmbed) this.fetchSubscribedStatus();\n\n                        const parser = new DOMParser();\n                        const xmlDoc = parser.parseFromString(this.video.description, \"text/html\");\n                        xmlDoc.querySelectorAll(\"a\").forEach(elem => {\n                            if (!elem.innerText.match(/(?:[\\d]{1,2}:)?(?:[\\d]{1,2}):(?:[\\d]{1,2})/))\n                                elem.outerHTML = elem.getAttribute(\"href\");\n                        });\n                        xmlDoc.querySelectorAll(\"br\").forEach(elem => (elem.outerHTML = \"\\n\"));\n                        this.video.description = rewriteDescription(xmlDoc.querySelector(\"body\").innerHTML);\n                        this.updateWatched(this.video.relatedStreams);\n\n                        this.fetchDeArrowContent(this.video.relatedStreams);\n                    }\n                });\n        },\n        async getPlaylistData() {\n            if (this.playlistId) {\n                this.playlist = await this.getPlaylist(this.playlistId);\n                await this.fetchPlaylistPages().then(() => {\n                    if (!(this.index >= 0)) {\n                        for (let i = 0; i < this.playlist.relatedStreams.length; i++)\n                            if (this.playlist.relatedStreams[i].url.substr(-11) == this.getVideoId()) {\n                                this.index = i + 1;\n                                this.$router.replace({\n                                    query: { ...this.$route.query, index: this.index },\n                                });\n                                break;\n                            }\n                    }\n                });\n                await this.fetchPlaylistPages();\n            }\n        },\n        async fetchPlaylistPages() {\n            if (this.playlist.nextpage) {\n                await this.fetchJson(this.apiUrl() + \"/nextpage/playlists/\" + this.playlistId, {\n                    nextpage: this.playlist.nextpage,\n                }).then(json => {\n                    this.playlist.relatedStreams.push(...json.relatedStreams);\n                    this.playlist.nextpage = json.nextpage;\n                    this.fetchDeArrowContent(json.relatedStreams);\n                });\n                await this.fetchPlaylistPages();\n            }\n        },\n        async getSponsors() {\n            if (this.getPreferenceBoolean(\"sponsorblock\", true))\n                this.fetchSponsors().then(data => (this.sponsors = data));\n        },\n        async getComments() {\n            this.comments = await this.fetchComments();\n        },\n        async fetchSubscribedStatus() {\n            if (!this.channelId) return;\n\n            this.subscribed = await this.fetchSubscriptionStatus(this.channelId);\n        },\n        subscribeHandler() {\n            this.toggleSubscriptionState(this.channelId, this.subscribed).then(success => {\n                if (success) this.subscribed = !this.subscribed;\n            });\n        },\n        handleClick(event) {\n            if (!event || !event.target) return;\n            if (!event.target.matches(\"a[href]\")) return;\n            const target = event.target;\n            if (!target.getAttribute(\"href\")) return;\n            if (this.handleTimestampLinks(target)) {\n                event.preventDefault();\n            }\n        },\n        handleTimestampLinks(target) {\n            try {\n                const url = new URL(target.getAttribute(\"href\"), document.baseURI);\n                if (\n                    url.searchParams.size > 2 ||\n                    url.searchParams.get(\"v\") !== this.getVideoId() ||\n                    !url.searchParams.has(\"t\")\n                ) {\n                    return false;\n                }\n                const time = parseTimeParam(url.searchParams.get(\"t\"));\n                if (time) {\n                    this.navigate(time);\n                }\n                return true;\n            } catch (e) {\n                console.error(e);\n            }\n            return false;\n        },\n        handleScroll() {\n            if (this.loading || !this.comments || !this.comments.nextpage) return;\n            if (window.innerHeight + window.scrollY >= this.$refs.comments?.offsetHeight - window.innerHeight) {\n                this.loading = true;\n                this.fetchJson(this.apiUrl() + \"/nextpage/comments/\" + this.getVideoId(), {\n                    nextpage: this.comments.nextpage,\n                }).then(json => {\n                    this.comments.nextpage = json.nextpage;\n                    this.loading = false;\n                    this.comments.comments = this.comments.comments.concat(json.comments);\n                });\n            }\n        },\n        getVideoId() {\n            if (this.$route.query.video_ids) {\n                const videos_list = this.$route.query.video_ids.split(\",\");\n                this.index = Number(this.$route.query.index ?? 0);\n                return videos_list[this.index];\n            }\n\n            return this.$route.query.v || this.$route.params.v;\n        },\n        navigate(time) {\n            this.$refs.videoPlayer.seek(time);\n        },\n        onTimeUpdate(time) {\n            this.currentTime = time;\n        },\n        onVideoEnded() {\n            if (\n                !this.selectedAutoLoop &&\n                this.selectedAutoPlay &&\n                (this.playlist?.relatedStreams?.length > 0 || this.video.relatedStreams.length > 0)\n            ) {\n                this.showToast();\n            }\n        },\n        showToast() {\n            this.counter = this.defaultCounter;\n            if (this.counter < 1) {\n                this.navigateNext();\n                return;\n            }\n            if (this.timeoutCounter) clearInterval(this.timeoutCounter);\n            this.timeoutCounter = setInterval(() => {\n                this.counter--;\n                if (this.counter === 0) {\n                    this.dismiss();\n                    this.navigateNext();\n                }\n            }, 1000);\n            this.shouldShowToast = true;\n        },\n        dismiss() {\n            clearInterval(this.timeoutCounter);\n            this.shouldShowToast = false;\n        },\n        navigateNext() {\n            const params = this.$route.query;\n            const video_ids = this.$route.query.video_ids?.split(\",\") ?? [];\n            let url;\n            if (this.playlist) {\n                url = this.playlist?.relatedStreams?.[this.index]?.url ?? this.video.relatedStreams[0].url;\n            } else if (video_ids.length > this.index + 1) {\n                url = `${this.$route.path}?index=${this.index + 1}`;\n            } else {\n                url = this.video.relatedStreams[0].url;\n            }\n            const searchParams = new URLSearchParams();\n            for (var param in params)\n                switch (param) {\n                    case \"v\":\n                    case \"t\":\n                        break;\n                    case \"index\":\n                        if (this.playlist && this.index < this.playlist.relatedStreams.length)\n                            searchParams.set(\"index\", this.index + 1);\n                        break;\n                    case \"list\":\n                        if (this.index < this.playlist.relatedStreams.length) searchParams.set(\"list\", params.list);\n                        break;\n                    default:\n                        searchParams.set(param, params[param]);\n                        break;\n                }\n            // save the fullscreen state\n            searchParams.set(\"fullscreen\", this.$refs.videoPlayer.$ui.getControls().isFullScreenEnabled());\n            const paramStr = searchParams.toString();\n            if (paramStr.length > 0) url += \"&\" + paramStr;\n            this.$router.push(url);\n        },\n        downloadCurrentFrame() {\n            const video = document.querySelector(\"video\");\n            const canvas = document.createElement(\"canvas\");\n            canvas.width = video.videoWidth;\n            canvas.height = video.videoHeight;\n\n            const context = canvas.getContext(\"2d\");\n            context.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n            let link = document.createElement(\"a\");\n            const currentTime = Math.round(video.currentTime * 1000) / 1000;\n            link.download = `${this.video.title}_${currentTime}s.png`;\n            link.href = canvas.toDataURL();\n            link.click();\n        },\n    },\n};\n</script>\n\n<style>\n.v-enter-from,\n.v-leave-to {\n    opacity: 0;\n    transform: translateX(100%) scale(0.5);\n}\n\n.description a {\n    text-decoration: underline;\n    filter: brightness(0.75);\n}\n</style>\n"],"file":"assets/WatchVideo-iIex-qcf.js"}