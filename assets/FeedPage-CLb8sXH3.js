import{V}from"./VideoItem-BNJ24tbL.js";import{_ as x}from"./SortingSelector-tQi2cfZ5.js";import{L as F}from"./LoadingIndicatorPage-D98bvYGK.js";import{a as b,c as r,w as d,b as o,t as f,v,F as a,f as m,d as g,e as G,r as h,h as k,o as l,g as N,j as y}from"./index-DFHtCH6M.js";import"./ModalComponent-B-ePo8ic.js";import"./CreatePlaylistModal-D_amQld8.js";import"./ConfirmModal-DRMIgDMG.js";const L={components:{VideoItem:V,SortingSelector:x,LoadingIndicatorPage:F},data(){return{currentVideoCount:0,videoStep:100,videosStore:null,videos:[],availableFilters:["all","shorts","videos"],selectedFilter:"all",selectedGroupName:"",channelGroups:[]}},computed:{getRssUrl(e){return e.authenticated?e.authApiUrl()+"/feed/rss?authToken="+e.getAuthToken():e.authApiUrl()+"/feed/unauthenticated/rss?channels="+e.getUnauthenticatedChannels()},filteredVideos(e){const s=e.channelGroups.filter(i=>i.groupName==e.selectedGroupName),p=this.getPreferenceBoolean("hideWatched",!1)?this.videos.filter(i=>!i.watched):this.videos;return e.selectedGroupName==""?p:p.filter(i=>s[0].channels.includes(i.uploaderUrl.substr(-24)))}},mounted(){var e;this.fetchFeed().then(s=>{if(s.error){alert(s.error);return}this.videosStore=s,this.loadMoreVideos(),this.updateWatched(this.videos)}),this.selectedFilter=(e=this.getPreferenceString("feedFilter"))!=null?e:"all",window.db&&this.loadChannelGroups()},activated(){document.title=this.$t("titles.feed")+" - Piped",this.videos.length>0&&this.updateWatched(this.videos),window.addEventListener("scroll",this.handleScroll)},deactivated(){window.removeEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)},methods:{async loadChannelGroups(){const e=await this.getChannelGroups();this.channelGroups.push(...e)},loadMoreVideos(){this.videosStore&&(this.currentVideoCount=Math.min(this.currentVideoCount+this.videoStep,this.videosStore.length),this.videos.length!=this.videosStore.length&&(this.fetchDeArrowContent(this.videosStore.slice(this.videos.length,this.currentVideoCount)),this.videos=this.videosStore.slice(0,this.currentVideoCount)))},handleScroll(){window.innerHeight+window.scrollY>=document.body.offsetHeight-window.innerHeight&&this.loadMoreVideos()},shouldShowVideo(e){switch(this.selectedFilter.toLowerCase()){case"shorts":return e.isShort;case"videos":return!e.isShort;default:return!0}},onFilterChange(){this.setPreference("feedFilter",this.selectedFilter)}}},P={class:"my-4 text-center font-bold"},U={class:"flex flex-col flex-wrap gap-2 children:flex children:items-center children:gap-1 md:flex-row md:items-center"},I={for:"filters"},A=["textContent"],B=["value"],M={for:"group-selector"},D=["textContent"],E={value:""},H=["value","textContent"],W={class:"md:ml-auto"},R=o("hr",null,null,-1),T={class:"flex gap-2"},j=["href"],Y=o("i",{class:"i-fa6-solid:rss"},null,-1),q=[Y],z=o("hr",null,null,-1);function J(e,s,p,i,n,c){const _=h("SortingSelector"),w=h("router-link"),S=h("VideoItem"),C=h("LoadingIndicatorPage"),u=k("t");return l(),r(a,null,[d(o("h1",P,null,512),[[u,"titles.feed"]]),o("div",U,[o("span",null,[o("label",I,[o("strong",{textContent:f("".concat(e.$t("actions.filter"),":"))},null,8,A)]),d(o("select",{id:"filters","onUpdate:modelValue":s[0]||(s[0]=t=>n.selectedFilter=t),default:"all",class:"select flex-grow",onChange:s[1]||(s[1]=t=>c.onFilterChange())},[(l(!0),r(a,null,m(n.availableFilters,t=>d((l(),r("option",{key:t,value:t},null,8,B)),[[u,"video.".concat(t)]])),128))],544),[[v,n.selectedFilter]])]),o("span",null,[o("label",M,[o("strong",{textContent:f("".concat(e.$t("titles.channel_groups"),":"))},null,8,D)]),d(o("select",{id:"group-selector","onUpdate:modelValue":s[2]||(s[2]=t=>n.selectedGroupName=t),default:"",class:"select flex-grow"},[d(o("option",E,null,512),[[u,"video.all"]]),(l(!0),r(a,null,m(n.channelGroups,t=>(l(),r("option",{key:t.groupName,value:t.groupName,textContent:f(t.groupName)},null,8,H))),128))],512),[[v,n.selectedGroupName]])]),o("span",W,[g(_,{"by-key":"uploaded",onApply:s[3]||(s[3]=t=>n.videos.sort(t))})])]),R,o("span",T,[d(g(w,{class:"btn",to:"/subscriptions"},null,512),[[u,"titles.subscriptions"]]),o("a",{href:c.getRssUrl,class:"btn"},q,8,j)]),z,g(C,{"show-content":n.videosStore!=null,class:"video-grid"},{default:G(()=>[(l(!0),r(a,null,m(c.filteredVideos,t=>(l(),r(a,{key:t.url},[c.shouldShowVideo(t)?(l(),N(S,{key:0,"is-feed":!0,item:t},null,8,["item"])):y("",!0)],64))),128))]),_:1},8,["show-content"])],64)}const te=b(L,[["render",J]]);export{te as default};
//# sourceMappingURL=FeedPage-CLb8sXH3.js.map
