System.register(["./VideoItem-legacy-DDmFzm8y.js","./SortingSelector-legacy-_Zk7orG_.js","./LoadingIndicatorPage-legacy-rxdJgMZA.js","./index-legacy-CmTDz3X_.js","./ModalComponent-legacy-BmTvlHoT.js","./CreatePlaylistModal-legacy-Bg0tm0yq.js","./ConfirmModal-legacy-CnRD7ob6.js"],(function(e,t){"use strict";var l,o,s,n,i,r,d,a,c,u,h,g,p,f,v,m,w,S;return{setters:[e=>{l=e.V},e=>{o=e._},e=>{s=e.L},e=>{n=e.a,i=e.c,r=e.w,d=e.b,a=e.t,c=e.v,u=e.F,h=e.f,g=e.d,p=e.e,f=e.r,v=e.h,m=e.o,w=e.g,S=e.j},null,null,null],execute:function(){const t={components:{VideoItem:l,SortingSelector:o,LoadingIndicatorPage:s},data:()=>({currentVideoCount:0,videoStep:100,videosStore:null,videos:[],availableFilters:["all","shorts","videos"],selectedFilter:"all",selectedGroupName:"",channelGroups:[]}),computed:{getRssUrl:e=>e.authenticated?e.authApiUrl()+"/feed/rss?authToken="+e.getAuthToken():e.authApiUrl()+"/feed/unauthenticated/rss?channels="+e.getUnauthenticatedChannels(),filteredVideos(e){const t=e.channelGroups.filter((t=>t.groupName==e.selectedGroupName)),l=this.getPreferenceBoolean("hideWatched",!1)?this.videos.filter((e=>!e.watched)):this.videos;return""==e.selectedGroupName?l:l.filter((e=>t[0].channels.includes(e.uploaderUrl.substr(-24))))}},mounted(){this.fetchFeed().then((e=>{e.error?alert(e.error):(this.videosStore=e,this.loadMoreVideos(),this.updateWatched(this.videos))})),this.selectedFilter=this.getPreferenceString("feedFilter")??"all",window.db&&this.loadChannelGroups()},activated(){document.title=this.$t("titles.feed")+" - Piped",this.videos.length>0&&this.updateWatched(this.videos),window.addEventListener("scroll",this.handleScroll)},deactivated(){window.removeEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)},methods:{async loadChannelGroups(){const e=await this.getChannelGroups();this.channelGroups.push(...e)},loadMoreVideos(){this.videosStore&&(this.currentVideoCount=Math.min(this.currentVideoCount+this.videoStep,this.videosStore.length),this.videos.length!=this.videosStore.length&&(this.fetchDeArrowContent(this.videosStore.slice(this.videos.length,this.currentVideoCount)),this.videos=this.videosStore.slice(0,this.currentVideoCount)))},handleScroll(){window.innerHeight+window.scrollY>=document.body.offsetHeight-window.innerHeight&&this.loadMoreVideos()},shouldShowVideo(e){switch(this.selectedFilter.toLowerCase()){case"shorts":return e.isShort;case"videos":return!e.isShort;default:return!0}},onFilterChange(){this.setPreference("feedFilter",this.selectedFilter)}}},C={class:"my-4 text-center font-bold"},y={class:"flex flex-col flex-wrap gap-2 children:flex children:items-center children:gap-1 md:flex-row md:items-center"},V={for:"filters"},x=["textContent"],b=["value"],F={for:"group-selector"},G=["textContent"],L={value:""},N=["value","textContent"],j={class:"md:ml-auto"},k=d("hr",null,null,-1),M={class:"flex gap-2"},P=["href"],U=[d("i",{class:"i-fa6-solid:rss"},null,-1)],I=d("hr",null,null,-1);e("default",n(t,[["render",function(e,t,l,o,s,n){const $=f("SortingSelector"),A=f("router-link"),E=f("VideoItem"),H=f("LoadingIndicatorPage"),W=v("t");return m(),i(u,null,[r(d("h1",C,null,512),[[W,"titles.feed"]]),d("div",y,[d("span",null,[d("label",V,[d("strong",{textContent:a(`${e.$t("actions.filter")}:`)},null,8,x)]),r(d("select",{id:"filters","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedFilter=e),default:"all",class:"select flex-grow",onChange:t[1]||(t[1]=e=>n.onFilterChange())},[(m(!0),i(u,null,h(s.availableFilters,(e=>r((m(),i("option",{key:e,value:e},null,8,b)),[[W,`video.${e}`]]))),128))],544),[[c,s.selectedFilter]])]),d("span",null,[d("label",F,[d("strong",{textContent:a(`${e.$t("titles.channel_groups")}:`)},null,8,G)]),r(d("select",{id:"group-selector","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedGroupName=e),default:"",class:"select flex-grow"},[r(d("option",L,null,512),[[W,"video.all"]]),(m(!0),i(u,null,h(s.channelGroups,(e=>(m(),i("option",{key:e.groupName,value:e.groupName,textContent:a(e.groupName)},null,8,N)))),128))],512),[[c,s.selectedGroupName]])]),d("span",j,[g($,{"by-key":"uploaded",onApply:t[3]||(t[3]=e=>s.videos.sort(e))})])]),k,d("span",M,[r(g(A,{class:"btn",to:"/subscriptions"},null,512),[[W,"titles.subscriptions"]]),d("a",{href:n.getRssUrl,class:"btn"},U,8,P)]),I,g(H,{"show-content":null!=s.videosStore,class:"video-grid"},{default:p((()=>[(m(!0),i(u,null,h(n.filteredVideos,(e=>(m(),i(u,{key:e.url},[n.shouldShowVideo(e)?(m(),w(E,{key:0,"is-feed":!0,item:e},null,8,["item"])):S("",!0)],64)))),128))])),_:1},8,["show-content"])],64)}]]))}}}));
//# sourceMappingURL=FeedPage-legacy-U3hHs_o6.js.map
