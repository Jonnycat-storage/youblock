System.register(["./WatchOnButton-legacy-GiW_Hk0q.js","./ContentItem-legacy-dpAxIUVA.js","./LoadingIndicatorPage-legacy-rxdJgMZA.js","./ModalComponent-legacy-BmTvlHoT.js","./CreateGroupModal-legacy-BCXVk8ul.js","./index-legacy-CmTDz3X_.js"],(function(e,t){"use strict";var n,a,s,l,h,o,i,c,r,d,u,b,p,m,g,C,f,x,w,y,v,k;return{setters:[e=>{n=e.E,a=e.W,s=e.C},e=>{l=e._},e=>{h=e.L},e=>{o=e.M},e=>{i=e.C},e=>{c=e.a,r=e.o,d=e.c,u=e.d,b=e.e,p=e.b,m=e.w,g=e.F,C=e.f,f=e.t,x=e.g,w=e.j,y=e.r,v=e.h,k=e.n}],execute:function(){var t=document.createElement("style");t.textContent=".active{border:.1rem outset red}\n",document.head.appendChild(t);const S={components:{ModalComponent:o,CreateGroupModal:i},props:{channelId:{type:String,required:!0}},emits:["close"],data:()=>({showCreateGroupModal:!1,channelGroups:[]}),mounted(){this.loadChannelGroups()},methods:{async loadChannelGroups(){const e=await this.getChannelGroups();this.channelGroups.push(...e)},onCheckedChange(e,t){t.channels.includes(this.channelId)?t.channels.splice(e,1):t.channels.push(this.channelId),this.createOrUpdateChannelGroup(t)},onCreateGroup(e){if(!e||this.channelGroups.some((t=>t.groupName==e)))return;const t={groupName:e,channels:[]};this.channelGroups.push(t),this.createOrUpdateChannelGroup(t),this.showCreateGroupModal=!1}}},G={class:"min-w-[50vw] flex flex-col"},T={class:"h-[70vh] overflow-y-scroll pr-4"},I={class:"mb-3 inline-block w-max text-2xl"},M={class:"flex items-center justify-between"},N=["checked","onChange"],$=p("hr",{class:"h-1 w-full"},null,-1),P={components:{ErrorHandler:n,ContentItem:l,WatchOnButton:a,LoadingIndicatorPage:h,CollapsableText:s,AddToGroupModal:c(S,[["render",function(e,t,n,a,s,l){const h=y("ModalComponent"),o=y("CreateGroupModal"),i=v("t");return r(),d(g,null,[u(h,{onClose:t[1]||(t[1]=t=>e.$emit("close"))},{default:b((()=>[p("div",G,[p("div",T,[m(p("span",I,null,512),[[i,"actions.add_to_group"]]),(r(!0),d(g,null,C(s.channelGroups,((e,t)=>(r(),d("div",{key:e.groupName,class:"px-1"},[p("div",M,[p("span",null,f(e.groupName),1),p("input",{type:"checkbox",checked:e.channels.includes(n.channelId),onChange:n=>l.onCheckedChange(t,e)},null,40,N)]),$])))),128))]),m(p("button",{class:"btn ml-auto w-max",onClick:t[0]||(t[0]=e=>s.showCreateGroupModal=!0)},null,512),[[i,"actions.create_group"]])])])),_:1}),s.showCreateGroupModal?(r(),x(o,{key:0,"on-create-group":l.onCreateGroup,onClose:t[2]||(t[2]=e=>s.showCreateGroupModal=!1)},null,8,["on-create-group"])):w("",!0)],64)}]])},data:()=>({channel:null,subscribed:!1,tabs:[],selectedTab:0,contentItems:[],showGroupModal:!1}),mounted(){this.getChannelData()},activated(){this.channel&&!this.channel.error&&(document.title=this.channel.name+" - Piped"),window.addEventListener("scroll",this.handleScroll),this.channel&&!this.channel.error&&this.updateWatched(this.channel.relatedStreams)},deactivated(){window.removeEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)},methods:{async fetchSubscribedStatus(){this.channel.id&&(this.subscribed=await this.fetchSubscriptionStatus(this.channel.id))},async fetchChannel(){const e=this.$route.path.includes("@")?this.apiUrl()+"/@/"+this.$route.params.channelId:this.apiUrl()+"/"+this.$route.params.path+"/"+this.$route.params.channelId;return await this.fetchJson(e)},async getChannelData(){this.fetchChannel().then((e=>this.channel=e)).then((()=>{if(!this.channel.error){document.title=this.channel.name+" - Piped",this.contentItems=this.channel.relatedStreams,this.fetchSubscribedStatus(),this.updateWatched(this.channel.relatedStreams),this.fetchDeArrowContent(this.channel.relatedStreams),this.tabs.push({translatedName:this.$t("video.videos")});const e=this.$route.query.tab;for(let t=0;t<this.channel.tabs.length;t++){let n=this.channel.tabs[t];n.translatedName=this.getTranslatedTabName(n.name),this.tabs.push(n),n.name===e&&this.loadTab(t+1)}}}))},handleScroll(){!this.loading&&this.channel&&this.channel.nextpage&&(0==this.selectedTab||this.tabs[this.selectedTab].tabNextPage)&&window.innerHeight+window.scrollY>=document.body.offsetHeight-window.innerHeight&&(this.loading=!0,0==this.selectedTab?this.fetchChannelNextPage():this.fetchChannelTabNextPage())},fetchChannelNextPage(){this.fetchJson(this.apiUrl()+"/nextpage/channel/"+this.channel.id,{nextpage:this.channel.nextpage}).then((e=>{this.channel.nextpage=e.nextpage,this.loading=!1,this.updateWatched(e.relatedStreams),this.contentItems.push(...e.relatedStreams),this.fetchDeArrowContent(e.relatedStreams)}))},fetchChannelTabNextPage(){this.fetchJson(this.apiUrl()+"/channels/tabs",{data:this.tabs[this.selectedTab].data,nextpage:this.tabs[this.selectedTab].tabNextPage}).then((e=>{this.tabs[this.selectedTab].tabNextPage=e.nextpage,this.loading=!1,e.this.contentItems.push(...e.content),this.fetchDeArrowContent(e.content),this.tabs[this.selectedTab].content=this.contentItems}))},subscribeHandler(){this.toggleSubscriptionState(this.channel.id,this.subscribed).then((e=>{e&&(this.subscribed=!this.subscribed)}))},getTranslatedTabName(e){let t=e;switch(e){case"livestreams":t=this.$t("titles.livestreams");break;case"playlists":t=this.$t("titles.playlists");break;case"albums":t=this.$t("titles.albums");break;case"shorts":t=this.$t("video.shorts");break;default:console.error(`Tab name "${e}" is not translated yet!`)}return t},loadTab(e){this.selectedTab=e;const t=new URL(window.location);t.searchParams.set("tab",this.tabs[e].name??"videos"),window.history.replaceState(window.history.state,"",t),0!=e?this.tabs[e].content?this.contentItems=this.tabs[e].content:this.fetchJson(this.apiUrl()+"/channels/tabs",{data:this.tabs[e].data}).then((t=>{this.contentItems=this.tabs[e].content=t.content,this.fetchDeArrowContent(t.content),this.tabs[this.selectedTab].tabNextPage=t.nextpage})):this.contentItems=this.channel.relatedStreams}}},U=["src"],j={class:"flex flex-col items-center justify-between md:flex-row"},_={class:"flex place-items-center"},H=["src"],L={class:"flex items-center gap-1"},E=["textContent"],W={key:0,class:"i-fa6-solid:check !text-xl"},A={class:"flex gap-2"},D=["textContent"],O=["href"],J=[p("i",{class:"i-fa6-solid:rss"},null,-1)],B={class:"mx-1 my-2 flex"},R=["onClick"],q=["textContent"],F=p("hr",null,null,-1),Y={class:"video-grid"};e("default",c(P,[["render",function(e,t,n,a,s,l){const h=y("ErrorHandler"),o=y("CollapsableText"),i=y("WatchOnButton"),c=y("ContentItem"),S=y("AddToGroupModal"),G=y("LoadingIndicatorPage"),T=v("t");return r(),d(g,null,[s.channel&&s.channel.error?(r(),x(h,{key:0,message:s.channel.message,error:s.channel.error},null,8,["message","error"])):w("",!0),u(G,{"show-content":null!=s.channel&&!s.channel.error},{default:b((()=>[s.channel.bannerUrl?(r(),d("img",{key:0,loading:"lazy",src:s.channel.bannerUrl,class:"h-30 w-full object-cover py-1.5 md:h-50"},null,8,U)):w("",!0),p("div",j,[p("div",_,[p("img",{height:"48",width:"48",class:"m-1 rounded-full",src:s.channel.avatarUrl},null,8,H),p("div",L,[p("h1",{class:"!text-xl",textContent:f(s.channel.name)},null,8,E),s.channel.verified?(r(),d("i",W)):w("",!0)])]),p("div",A,[p("button",{class:"btn",onClick:t[0]||(t[0]=(...e)=>l.subscribeHandler&&l.subscribeHandler(...e)),textContent:f(e.$t("actions."+(s.subscribed?"unsubscribe":"subscribe"))+" - "+e.numberFormat(s.channel.subscriberCount))},null,8,D),s.subscribed?m((r(),d("button",{key:0,class:"btn",onClick:t[1]||(t[1]=e=>s.showGroupModal=!0)},null,512)),[[T,"actions.add_to_group"]]):w("",!0),s.channel.id?(r(),d("a",{key:1,"aria-label":"RSS feed",title:"RSS feed",role:"button",href:`${e.apiUrl()}/feed/unauthenticated/rss?channels=${s.channel.id}`,target:"_blank",class:"btn flex-col"},J,8,O)):w("",!0)])]),u(o,{text:s.channel.description},null,8,["text"]),u(i,{link:`https://youtube.com/channel/${s.channel.id}`},null,8,["link"]),p("div",B,[(r(!0),d(g,null,C(s.tabs,((e,t)=>(r(),d("button",{key:e.name,class:k(["btn mr-2",{active:s.selectedTab==t}]),onClick:e=>l.loadTab(t)},[p("span",{textContent:f(e.translatedName)},null,8,q)],10,R)))),128))]),F,p("div",Y,[(r(!0),d(g,null,C(s.contentItems,(e=>(r(),x(c,{key:e.url,item:e,height:"94",width:"168","hide-channel":""},null,8,["item"])))),128))]),s.showGroupModal?(r(),x(S,{key:1,"channel-id":s.channel.id.substr(-24),onClose:t[2]||(t[2]=e=>s.showGroupModal=!1)},null,8,["channel-id"])):w("",!0)])),_:1},8,["show-content"])],64)}]]))}}}));
//# sourceMappingURL=ChannelPage-legacy-tINBs-XP.js.map
